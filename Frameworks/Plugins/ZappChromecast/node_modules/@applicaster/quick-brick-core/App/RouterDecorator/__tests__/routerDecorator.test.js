import * as React from "react";
import { View } from "react-native";
import ReactTestRenderer from "react-test-renderer";

import { createRouterDecorator } from "../index";

function createMockComponent(mockName, hasChildren = false) {
  return hasChildren
    ? jest.fn(({ children }) => <View comp={mockName}>{children}</View>)
    : jest.fn(props => <View comp={mockName} {...props} />);
}

const Router = createMockComponent("Router", true);
const SomeComp = createMockComponent("SomeComp");

describe("routerDecorator", () => {
  it("is a function", () => {
    expect(createRouterDecorator).toBeFunction();
  });

  it("returns a decorator", () => {
    expect(createRouterDecorator(Router)).toBeFunction();
  });

  it("wraps a component with the router", () => {
    const decorator = createRouterDecorator(Router);
    const DecoratedComp = decorator(SomeComp);

    const wrapper = ReactTestRenderer.create(<DecoratedComp foo="bar" />);
    expect(wrapper.toJSON()).toMatchSnapshot();
  });
});
