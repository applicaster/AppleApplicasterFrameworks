jest.mock("react-native", () => ({
  NativeModules: {
    AnalyticsBridge: undefined,
  },
}));

const eventName = "event";
const payload = {};

const analyticsManager = require("../manager");

const consoleSpy = jest.spyOn(console, "warn").mockImplementation(() => {});

describe("AnalyticsManager - with undefined Native Module", () => {
  beforeEach(() => {
    consoleSpy.mockClear();
  });

  it("doesn't crash when calling the methods", () => {
    expect(() =>
      analyticsManager.postAnalyticEvent(eventName, payload)
    ).not.toThrow();

    expect(() => analyticsManager.providePlugins([], {})).not.toThrow();

    expect(() =>
      analyticsManager.startAnalyticsTimedEvent(eventName, payload)
    ).not.toThrow();

    expect(() =>
      analyticsManager.endAnalyticsTimedEvent(eventName, payload)
    ).not.toThrow();

    expect(consoleSpy).toHaveBeenCalledTimes(4);

    expect(consoleSpy.mock.calls).toMatchSnapshot();
  });
});
