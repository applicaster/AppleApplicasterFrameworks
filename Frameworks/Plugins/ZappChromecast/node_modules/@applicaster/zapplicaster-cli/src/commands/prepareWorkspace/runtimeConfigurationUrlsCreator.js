const R = require("ramda");
const { saveConfigFile } = require("../../render");

/**
 * @typedef configuration
 * @type {Object}
 * @property {Object} buildParams: zapp build params for the app
 * @property {String} destinationPath: Rendered app path
 * @property {String} platform: Platform of the app
 */

async function runtimeConfigurationUrlsCreator(configuration) {
  const runtimeConfigurationUrls = R.compose(
    R.reject(R.isNil),
    R.pick([
      "styles_url",
      "remote_configurations_url",
      "plugin_configurations_url",
      "rivers_url",
      "cell_styles_url",
    ])
  )(configuration.buildParams);

  await saveConfigFile(
    configuration,
    "runtime_configuration_urls.json",
    runtimeConfigurationUrls
  );
  return true;
}

module.exports = { runtimeConfigurationUrlsCreator };
