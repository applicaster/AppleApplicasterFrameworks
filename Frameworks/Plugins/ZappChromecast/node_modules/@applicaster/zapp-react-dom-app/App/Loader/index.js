import { displaySplash } from "./displaySplash";
import { loadLocalizations } from "./loadLocalizations";
import { loadAnalyticsPlugins } from "./loadAnalyticsPlugins";
import { loadDomPlugins } from "./loadDomPlugins";
import { loadLocale } from "./loadLocale";

export function appLoader(dispatch, getState) {
  const { localizations, plugins, pluginConfigurations } = getState();

  const loaders = [
    loadLocalizations(localizations, dispatch),
    loadAnalyticsPlugins(plugins, pluginConfigurations),
    displaySplash(),
    loadDomPlugins(plugins),
    loadLocale(),
  ];

  return new Promise((resolve, reject) => {
    Promise.all(loaders)
      .then(resolve)
      .catch(reject);
  });
}
